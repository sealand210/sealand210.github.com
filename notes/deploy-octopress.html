
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dreaming in Digital - A blog by Evan Hung</title>
  <meta name="author" content="Evan Hung">

  
  <meta name="description" content="linux, ios, mac, arduino, design, digital">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dreaming-in-digital.me/notes/deploy-octopress.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Dreaming in Digital" type="application/atom+xml">
  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30026048-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <header role="banner"><div style="display: block; margin-left: 0; margin-right: auto; max-width: 100%; width: 850px; padding-bottom: -1.75em;">
<a href="/">
	<img src="/images/logo.png" style="max-width:100%;"/>
</a>
</div>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dreaming-in-digital.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/my-collections">My Collections</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <ul>
<li><h3>认识github</h3></li>
</ul>


<p>github其实就是一个具有社区功能的代码管理网站，方便开源程序的协力开发，当然它也可以成为软件公司的代码分布平台，但是如果你不想公开你的代码，就必须缴纳年费。</p>

<p>在github上建站最好将repo名称设置成username.github.com的模式，之后username.github.com这个连接就会自动打开repo内的index.html，而不是github的网站页面。</p>

<p>创建好名为username.github.com的repo后上传一个index.html到master branch来完成建站的准备工作：</p>

<!-- more -->


<p>开始之前先设定git SSh密匙，和git用户全局参数，参照www.github.com</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git init
</span><span class='line'>$ git remote add origin git@github.com:username/username.github.com.git
</span><span class='line'>$ echo "My GitHub Page" > index.html
</span><span class='line'>$ git add .
</span><span class='line'>$ git commit -a -m "First pages commit"
</span><span class='line'>$ git push origin master</span></code></pre></td></tr></table></div></figure>


<p>刷新<code>username.github.com</code>可以看到<code>My GitHub Page</code>的字样就完成了。</p>

<p>了解github指令和更多的用法：
<a href="http://rogerdudler.github.com/git-guide/index.zh.html">git - the simple guide - no deep shit</a></p>

<h5>部署Octopress到github</h5>

<p>进入octopress目录,设定远程仓库：</p>

<pre><code>$ git remote add origin git@github.com:username/
$ rake setup_github_pages #设定Github账户目录
</code></pre>

<p>之后它会提示输入github账户名，按照一下形式输入：</p>

<pre><code>git@github.com:username/username.github.com.git
</code></pre>

<p>如果已经执行过rake generate,则可以直接进行部署了：</p>

<pre><code>$ rake deploy
</code></pre>

<p>完成后将源码保存到github的source branch</p>

<pre><code>$ git add .
$ git commit -m 'site updated'
$ git push origin HEAD:source
</code></pre>

<h5>绑定域名</h5>

<pre><code>$ echo '你要绑定的域名' &gt;&gt; source/CNAME
</code></pre>

<p>将你要绑定的域名CNAME到 http://你的GitHub用户名.github.com，如果是@纪录，需要加入207.97.227.245。</p>

<h5>编辑已经在github搭建好的Octopress：</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd local.blog.path  #选择一个本地目录保存octopress
</span><span class='line'>$ git init                
</span><span class='line'>$ git remote add origin git@github.com:username/username.github.com.git
</span><span class='line'>$ git pull origin source      #从source抓取网站源码
</span><span class='line'>$ gem install bundler
</span><span class='line'>$ bundle install
</span><span class='line'>$ sudo rm -rf _deploy
</span><span class='line'>$ rake setup_github_pages #设定账户名
</span><span class='line'>git@github.com:username/username.github.com.git</span></code></pre></td></tr></table></div></figure>


<h2>认识heroku</h2>

<p>Heroku 是云端应用程式平台，可以想成是「云端上的网页空间」，不同于传统网页空间的计费方式，Heroku 是按照你所使用的资源来计费的，像是 CPU、RAM 使用越多就需要付越多钱，不过免费的方案已经够一般应用程式使用了。对比github，heroku的好处是repo是不公开的，也就是说除了作者外没有人可以看到网站目录。而且个人感觉在国内浏览heroku好像比github快</p>

<p>要使用heroku,先得要安装heroku工具：</p>

<pre><code>$ gem install heroku   #在octopress目录内
</code></pre>

<p>之后就可以直接登陆heroku:</p>

<pre><code>$ heoku login
</code></pre>

<p>首次使用需要上传RSA密匙:</p>

<pre><code>$ heroku keys:add
$ heroku keys   #查看是否上传成功
</code></pre>

<p>最后就可以开始创建程序了(appName为自定义程序名)：</p>

<pre><code>$ heroku create appName
</code></pre>

<h5>部署Octopress到heroku</h5>

<p>首先要修改 <code>.gitignore</code> 文件，去掉文档中的 <code>public</code>,否则git不会 上传public文件夹，会出现网站无法访问的错误</p>

<p>设定默认的远程库为heroku</p>

<pre><code># Set heroku to be the default remote for push/fetch
git config branch.master.remote heroku
</code></pre>

<p>如果已经用rake generate生成过网站则可以直接开始部署了：</p>

<pre><code>git add .
git commit -m 'site updated'
git push heroku master
</code></pre>

<p>如果出现 <code>Permission Denied(public key)</code> 则会有两种可能：</p>

<p>1.生成的rsa密匙不是默认的id_rsa名称，则需要在 <code>~/.ssh</code> 目录中添加<code>config</code> 文件将heroku的密匙指向你设定的密匙：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Host heroku.com
</span><span class='line'>Hostname heroku.com
</span><span class='line'>Port 22
</span><span class='line'>IdentitiesOnly yes
</span><span class='line'>IdentityFile ~/.ssh/id_heroku
</span><span class='line'>TCPKeepAlive yes
</span><span class='line'>User brandon</span></code></pre></td></tr></table></div></figure>


<p>2.heroku进入了 <code>/root/.shh/</code>而不是<code>~/.ssh/</code>查找密匙, 简单将密匙拷贝过去就可以了:</p>

<pre><code>$ sudo cp ~/.ssh/id_rsa* /root/.ssh/
</code></pre>

<p>部署完成后就可以在appName.heroku.com看到octopress页面了</p>

<pre><code>$ heroku open    #查看应用
</code></pre>

<h5>编辑已经在heroku搭建好的Octopress</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#设定远程库
</span><span class='line'>git config branch.master.remote heroku
</span><span class='line'>git remote set-url heroku git@heroku.com:appName.git
</span><span class='line'>#抓取网站源码
</span><span class='line'>git clone git@heroku.com:appName.git -o heroku
</span><span class='line'>#生成上传
</span><span class='line'>rake generate
</span><span class='line'>git add .
</span><span class='line'>git commit -m 'site updated'
</span><span class='line'>git push heroku master</span></code></pre></td></tr></table></div></figure>


<h2>参考连接</h2>

<ul>
<li><a href="http://aboukone.com/2012/02/04/heroku-setup-git-push-heroku-master-permission-denied-ssh-issue/">http://aboukone.com/2012/02/04/heroku-setup-git-push-heroku-master-permission-denied-ssh-issue/</a></li>
<li><a href="http://zylstra.wordpress.com/2008/08/29/overcome-herokus-permission-denied-publickey-problem/">http://zylstra.wordpress.com/2008/08/29/overcome-herokus-permission-denied-publickey-problem/</a></li>
<li><a href="http://octopress.org/docs/deploying/heroku/">http://octopress.org/docs/deploying/heroku/</a></li>
<li><a href="http://octopress.org/docs/deploying/github/">http://octopress.org/docs/deploying/github/</a></li>
<li><a href="http://devcenter.heroku.com/articles/keys">http://devcenter.heroku.com/articles/keys</a></li>
</ul>


  
</article>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Evan Hung -
  <span class="credit">Hosted on <a href="http://heroku.com">Heroku</a> & <a href="http://github.com">GitHub</a> - Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'd-i-d';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
